var ht=Object.defineProperty;var ct=(e,n,t)=>n in e?ht(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var K=(e,n,t)=>ct(e,typeof n!="symbol"?n+"":n,t);import{t as et,a as Q}from"../chunks/CQCUd88O.js";import{i as mt}from"../chunks/OLJEn5Z9.js";import{h as U,z as ut,A as xt,C as dt,t as l,a5 as k,a6 as D,a7 as N,G as T,D as W,F as q,B as pt,a8 as wt}from"../chunks/BVYZijaG.js";import{s as G,e as R}from"../chunks/Dkkt5dkv.js";import{b as vt,i as gt}from"../chunks/Dni7qojp.js";import{o as yt}from"../chunks/CM1UF-lp.js";import"../chunks/C5wFzVUY.js";const V=[...` 	
\r\fÂ \v\uFEFF`];function Mt(e,n,t){var a=""+e;if(t){for(var s in t)if(t[s])a=a?a+" "+s:s;else if(a.length)for(var i=s.length,r=0;(r=a.indexOf(s,r))>=0;){var u=r+i;(r===0||V.includes(a[r-1]))&&(u===a.length||V.includes(a[u]))?a=(r===0?"":a.substring(0,r))+a.substring(u+1):r=u}}return a===""?null:a}function F(e,n,t,a,s,i){var r=e.__className;if(U||r!==t||r===void 0){var u=Mt(t,a,i);(!U||u!==e.getAttribute("class"))&&(u==null?e.removeAttribute("class"):e.className=u),e.__className=t}else if(i&&s!==i)for(var w in i){var c=!!i[w];(s==null||c!==!!s[w])&&e.classList.toggle(w,c)}return i}class f{constructor(n,t){this.x=n,this.y=t}}class bt{constructor(n){K(this,"topLeftX");K(this,"topLeftY");K(this,"zoom");this.canvas=n,this.topLeftX=0,this.topLeftY=0,this.zoom=1}transformPoint(n){return new f(this.transformX(n.x),this.transformY(n.y))}transformX(n){return n-this.topLeftX}transformY(n){return this.canvas.height-(n-this.topLeftY)}inverseTransformPoint(n){return new f(this.inverseTransformX(n.x),this.inverseTransformY(n.y))}inverseTransformX(n){return n+this.topLeftX}inverseTransformY(n){return this.canvas.height-n+this.topLeftY}getTopLeft(){return new f(this.topLeftX,this.topLeftY)}updateTopLeft(n){this.topLeftX=n.x,this.topLeftY=n.y}}class Tt{constructor(n,t,a){this.camera=n,this.context=t,this.canvas=a}}class Z{constructor(n,t,a,s,i){this.x=n,this.a=t,this.b=a,this.c=s,this.d=i}getIndex(n){if(n<this.x[0]||n>this.x[this.x.length-1]||Number.isNaN(n))return 0;{let t=0;for(;!(this.x[t]<=n&&n<=this.x[t+1]);)t++;return t}}compute(n){if(this.x.length<2||n<this.x[0]||n>this.x[this.x.length-1])return 0;let t=this.getIndex(n);return Math.pow(n,3)*this.a[t]+Math.pow(n,2)*this.b[t]+n*this.c[t]+this.d[t]}computeComponent(n,t){return Math.pow(n,3)*this.a[t]+Math.pow(n,2)*this.b[t]+n*this.c[t]+this.d[t]}computeDerivative(n){if(this.x.length<2||n<this.x[0]||n>this.x[this.x.length-1])return 0;let t=this.getIndex(n);return 3*Math.pow(n,2)*this.a[t]+2*n*this.b[t]+this.c[t]}computeSecondDerivative(n){if(this.x.length<2||n<this.x[0]||n>this.x[this.x.length-1])return 0;let t=this.getIndex(n);return 6*n*this.a[t]+2*this.b[t]}getMaxSecondDerivative(){let n=0;for(let t=0;t<this.x.length;t++)n=Math.max(this.computeSecondDerivative(this.x[t]),n);return n}computeIntegral(){let n=0;for(let t=0;t<this.x.length-1;t++){let a=this.x[t],s=this.x[t+1];n+=(s-a)/6*(this.compute(a)+4*this.compute((a+s)/2)+this.compute(s))}return n}}const Xt=e=>{const n=[...e].sort((o,m)=>o.x-m.x),t=n.length;if(t<2)return new Z(n.map(o=>o.x),[],[],[],[]);const a=t-1,s=n.map(o=>o.x),i=new Array(a),r=new Array(a);for(let o=0;o<a;o++)i[o]=n[o+1].x-n[o].x,r[o]=(n[o+1].y-n[o].y)/i[o];const u=new Array(t).fill(0),w=new Array(t).fill(0);if(a>1){u[1]=2*(i[0]+i[1]),w[1]=6*(r[1]-r[0]);for(let o=2;o<a;o++){const m=i[o-1]/u[o-1];u[o]=2*(i[o-1]+i[o])-i[o-1]*m,w[o]=6*(r[o]-r[o-1])-w[o-1]*m}}const c=new Array(t).fill(0);for(let o=a-1;o>=1;o--)c[o]=(w[o]-i[o]*c[o+1])/u[o];const _=new Array(a),A=new Array(a),S=new Array(a),C=new Array(a);for(let o=0;o<a;o++){const m=(c[o+1]-c[o])/(6*i[o]),x=c[o]/2,Y=r[o]-i[o]*(2*c[o]+c[o+1])/6,L=n[o].y,p=s[o];_[o]=m,A[o]=-3*m*p+x,S[o]=3*m*p*p-2*x*p+Y,C[o]=-m*p*p*p+x*p*p-Y*p+L}return new Z(s,_,A,S,C)},Yt=(e,n,t,a)=>{const s=t*a(n,e),i=t*a(n+1/2*t,e+1/2*s),r=t*a(n=1/2*t,e+1/2*i),u=t*a(n+t,e+r);return e+1/6*(s+2*i+2*r+u)},Lt=(e,n,t)=>{for(let a=-e.canvas.width*5;a<e.canvas.width*4;a+=n)e.context.beginPath(),e.context.strokeStyle="#ffe1a3",e.context.lineWidth=5,e.context.moveTo(e.camera.transformX(a),e.camera.transformY(0)),e.context.lineTo(e.camera.transformX(a),e.camera.transformY(t.compute(a))),e.context.stroke();for(let a=-e.canvas.width*5;a<e.canvas.width*4;a+=n)e.context.beginPath(),e.context.strokeStyle="#808080",e.context.lineWidth=5,e.context.moveTo(e.camera.transformX(a),e.camera.transformY(t.compute(a))),e.context.lineTo(e.camera.transformX(a+n),e.camera.transformY(t.compute(a+n))),e.context.stroke()},Pt=(e,n,t)=>{e.context.beginPath(),e.context.fillStyle="black";let a=t.compute(n),s=20;e.context.translate(e.camera.transformX(n),e.camera.transformY(a)),e.context.rotate(-Math.atan(t.computeDerivative(n))),e.context.fillRect(-20,-20,2*s,s),e.context.translate(e.camera.transformX(-n),e.camera.transformY(-a)),e.context.fill(),e.context.resetTransform()},kt=(e,n,t)=>{for(let a=0;a<n.length;a++){let s=n[a];e.context.beginPath(),e.context.fillStyle=t===a?"#606060":"#808080",e.context.arc(e.camera.transformX(s.x),e.camera.transformY(s.y),t===a?15:10,0,2*Math.PI),e.context.fill()}},_t=(e,n,t,a)=>{let s=t.getIndex(a);for(let i=-e.canvas.width*5;i<e.canvas.width*4;i+=n)e.context.beginPath(),e.context.strokeStyle="#c44cfc",e.context.lineWidth=5,e.context.moveTo(e.camera.transformX(i),e.camera.transformY(t.computeComponent(i,s))),e.context.lineTo(e.camera.transformX(i+n),e.camera.transformY(t.computeComponent(i+n,s))),e.context.stroke()},tt=(e,n,t)=>{e.context.beginPath(),e.context.moveTo(e.camera.transformX(n.x),e.camera.transformY(n.y)),e.context.lineTo(e.camera.transformX(t.x),e.camera.transformY(t.y));let a=Math.atan2(t.y-n.y,t.x-n.x),s=Math.sqrt(Math.pow(t.y-n.y,2)+Math.pow(t.x-n.x,2));e.context.moveTo(e.camera.transformX(t.x),e.camera.transformY(t.y)),e.context.lineTo(e.camera.transformX(t.x+Math.cos(a+Math.PI*4/5)*s/3),e.camera.transformY(t.y+Math.sin(a+Math.PI*4/5)*s/3)),e.context.moveTo(e.camera.transformX(t.x),e.camera.transformY(t.y)),e.context.lineTo(e.camera.transformX(t.x+Math.cos(a-Math.PI*4/5)*s/3),e.camera.transformY(t.y+Math.sin(a-Math.PI*4/5)*s/3)),e.context.stroke()},At=(e,n,t,a)=>{e.context.lineWidth=5;let s=Math.atan(n),i=-Math.sin(s)*60,r=Math.cos(s)*60;e.context.strokeStyle="#4c66fc",tt(e,new f(t,a),new f(t+Math.cos(s)*i,a+Math.sin(s)*i)),e.context.strokeStyle="#fc9b4c",tt(e,new f(t,a),new f(t+Math.cos(s-Math.PI/2)*r,a+Math.sin(s-Math.PI/2)*r))};var St=et('<div class="info svelte-185pfyu"><p><strong class="underline">Total area of your coaster:</strong> </p> <p><strong class="underline">Maximum acceleration:</strong> </p> <p><strong class="underline">Current coaster speed:</strong> </p> <p><button>Toggle component drawing</button> <button>Toggle forces</button> <button>Toggle follow</button></p></div>'),Ct=et('<canvas class="svelte-185pfyu"></canvas> <!>',1);function Gt(e,n){ut(n,!1);let t=k(),a,s=[new f(0,0),new f(194,181),new f(288,306),new f(401,373),new f(444,343),new f(469,380),new f(582,302),new f(617,372),new f(713,381),new f(744,303),new f(774,193),new f(821,104),new f(901,37),new f(971,10),new f(234,267),new f(651,387),new f(685,389)],i={x:0},r=-1,u=!1,w=k(!1),c,_=k(),A=k(),S=k(),C,o=.01,m,x=k({components:!1,forces:!1,follow:!1});const Y=()=>100/window.innerWidth,L=()=>{c=Xt(s),D(_,c.computeIntegral()*Y()),D(A,c.getMaxSecondDerivative()*Y())};yt(()=>{a=l(t).getContext("2d"),m=new bt(l(t)),window.addEventListener("keydown",h=>{h.key===" "?u=!0:h.key==="Escape"?D(w,!l(w)):h.key==="Backspace"?(s=[new f(0,0),new f(window.innerWidth,0)],L()):h.key==="p"&&(o=i.x)}),window.addEventListener("keyup",h=>{h.key===" "&&(u=!1)}),l(t).addEventListener("mousedown",h=>{let d=m.inverseTransformX(h.clientX),y=m.inverseTransformY(h.clientY),P=!1;for(let v=0;v<s.length;v++){const X=s[v];if(Math.hypot(X.x-d,X.y-y)<=10){r=v,P=!0;break}}P||(s.push(new f(d,y)),L())}),l(t).addEventListener("mousemove",h=>{if(i={x:h.clientX,y:h.clientY},r!==-1){if(s[r].x=m.inverseTransformX(h.clientX),s[r].y=m.inverseTransformY(h.clientY),r+1<s.length&&s[r].x>s[r+1].x){let d=s[r];s[r]=s[r+1],s[r+1]=d,r+=1}if(r-1>=0&&s[r].x<s[r-1].x){let d=s[r];s[r]=s[r-1],s[r-1]=d,r-=1}L()}if(u){console.log("DRAGGING");let d=m.getTopLeft();m.updateTopLeft(new f(d.x-h.movementX,d.y+h.movementY))}}),l(t).addEventListener("mouseup",h=>{r!=-1&&(r=-1)}),s.push(new f(window.innerWidth,0)),L(),$(0)});let p=0;const $=h=>{let d=h-p;p=h,N(t,l(t).width=window.innerWidth),N(t,l(t).height=window.innerHeight),a.fillStyle="skyblue",a.fillRect(0,0,l(t).width,l(t).height);let y=30,P=(g,b)=>{let I=y*Math.sqrt(Math.max(0,l(t).height*2/3-c.compute(b))),E=Math.atan(c.computeDerivative(b));return Math.cos(E)*I};C=y*Math.sqrt(l(t).height*2/3-c.compute(o)),o=Yt(o,0,d/1e3,P);let v=s.map(g=>g.x).reduce((g,b)=>Math.min(g,b)),X=s.map(g=>g.x).reduce((g,b)=>Math.max(g,b));o<v&&(o+=X-v),o>X&&(o-=X-v),l(x).follow&&m.updateTopLeft(new f(o-l(t).width/2,m.getTopLeft().y));let M=new Tt(m,a,l(t));Lt(M,10,c),l(x).components&&_t(M,10,c,o),kt(M,s,r),Pt(M,o,c),l(x).forces&&At(M,c.computeDerivative(o),o,c.compute(o)),D(S,C*Y()/1.467),requestAnimationFrame($)};mt();var B=Ct(),O=xt(B);vt(O,h=>D(t,h),()=>l(t));var nt=T(O,2);{var at=h=>{var d=St(),y=W(d),P=T(W(y));q(y);var v=T(y,2),X=T(W(v));q(v);var M=T(v,2),g=T(W(M));q(M);var b=T(M,2),I=W(b);let E;var z=T(I,2);let H;var j=T(z,2);let J;q(b),q(d),pt((ot,st,rt,it,lt,ft)=>{G(P,` ${ot??""} square feet.`),G(X,` ${st??""} feet per square second.`),G(g,` ${rt??""} miles per hour.`),E=F(I,1,"svelte-185pfyu",null,E,it),H=F(z,1,"svelte-185pfyu",null,H,lt),J=F(j,1,"svelte-185pfyu",null,J,ft)},[()=>Math.round(l(_)),()=>Math.round(l(A)*100)/100,()=>Math.round(l(S)),()=>({"button-selected":l(x).components}),()=>({"button-selected":l(x).forces}),()=>({"button-selected":l(x).follow})],wt),R("click",I,()=>N(x,l(x).components=!l(x).components)),R("click",z,()=>N(x,l(x).forces=!l(x).forces)),R("click",j,()=>N(x,l(x).follow=!l(x).follow)),Q(h,d)};gt(nt,h=>{l(w)&&h(at)})}Q(e,B),dt()}export{Gt as component};
